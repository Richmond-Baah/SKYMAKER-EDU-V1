(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[70],{69738:function(e,t,a){Promise.resolve().then(a.bind(a,16889))},16889:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return E}});var r=a(3827),s=a(64090),n=a(34599),i=a(27815),l=a(45179),d=a(24602),o=a(1657);function c(e){let{className:t,...a}=e;return(0,r.jsx)(d.f,{"data-slot":"label",className:(0,o.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}var u=a(23444),x=a(85754),m=a(9278),h=a(23441),f=a(80037),g=a(85159);function p(e){let{...t}=e;return(0,r.jsx)(m.fC,{"data-slot":"select",...t})}function b(e){let{...t}=e;return(0,r.jsx)(m.B4,{"data-slot":"select-value",...t})}function v(e){let{className:t,size:a="default",children:s,...n}=e;return(0,r.jsxs)(m.xz,{"data-slot":"select-trigger","data-size":a,className:(0,o.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[s,(0,r.jsx)(m.JO,{asChild:!0,children:(0,r.jsx)(h.Z,{className:"size-4 opacity-50"})})]})}function j(e){let{className:t,children:a,position:s="popper",...n}=e;return(0,r.jsx)(m.h_,{children:(0,r.jsxs)(m.VY,{"data-slot":"select-content",className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...n,children:[(0,r.jsx)(y,{}),(0,r.jsx)(m.l_,{className:(0,o.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,r.jsx)(N,{})]})})}function w(e){let{className:t,children:a,...s}=e;return(0,r.jsxs)(m.ck,{"data-slot":"select-item",className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...s,children:[(0,r.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,r.jsx)(m.wU,{children:(0,r.jsx)(f.Z,{className:"size-4"})})}),(0,r.jsx)(m.eT,{children:a})]})}function y(e){let{className:t,...a}=e;return(0,r.jsx)(m.u_,{"data-slot":"select-scroll-up-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,r.jsx)(g.Z,{className:"size-4"})})}function N(e){let{className:t,...a}=e;return(0,r.jsx)(m.$G,{"data-slot":"select-scroll-down-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,r.jsx)(h.Z,{className:"size-4"})})}var _=a(86443),k=a(56288),z=a(18994),S=a(11213),A=a(97336),C=a(77326),Z=a(43345),O=a(70699),P=a(50660);async function U(e,t){if(!n.O)throw Error("Supabase client not initialized");let a=t.name.split(".").pop(),r="".concat(e,"/avatar-").concat(Math.random(),".").concat(a),{error:s,data:i}=await n.O.storage.from("avatars").upload(r,t,{upsert:!0});if(s)throw s;let{data:{publicUrl:l}}=n.O.storage.from("avatars").getPublicUrl(r);return l}function E(){let[e,t]=(0,s.useState)(!0),[a,d]=(0,s.useState)(!1),[o,m]=(0,s.useState)(null),[h,f]=(0,s.useState)(""),[g,y]=(0,s.useState)(""),[N,E]=(0,s.useState)(""),[I,B]=(0,s.useState)(""),[G,F]=(0,s.useState)(""),[M,Y]=(0,s.useState)(""),[T,W]=(0,s.useState)(""),[L,R]=(0,s.useState)(!1),[X,q]=(0,s.useState)({profile_visibility:"public",show_on_leaderboard:!0,share_with_teacher:!0});(0,s.useEffect)(()=>{K()},[]);let K=async()=>{let{data:{user:e}}=await n.O.auth.getUser();if(!e)return;let{data:a}=await n.O.from("profiles").select("*").eq("id",e.id).single();a&&(m(a),f(a.username||""),y(a.full_name||""),E(a.bio||""),B(a.school||""),F(a.grade_level||""),Y(a.country||""),W(a.avatar_url||""),a.privacy_settings&&q(a.privacy_settings)),t(!1)},V=async e=>{try{var t;R(!0);let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;if(!a.type.startsWith("image/")){k.Am.error("Please upload an image file");return}if(a.size>2097152){k.Am.error("File size must be under 2MB");return}let{data:{user:r}}=await n.O.auth.getUser();if(!r)throw Error("Not authenticated");let s=await U(r.id,a);W(s),k.Am.success("Avatar uploaded! Save changes to finalize.")}catch(e){k.Am.error("Upload failed: "+e.message),console.error(e)}finally{R(!1)}},D=async()=>{d(!0);let{data:{user:e}}=await n.O.auth.getUser();try{let{error:t}=await n.O.from("profiles").update({username:h,full_name:g,bio:N,school:I,grade_level:G,country:M,avatar_url:T,privacy_settings:X,updated_at:new Date().toISOString()}).eq("id",e.id);if(t)throw t;let{error:a}=await n.O.auth.updateUser({data:{avatar_url:T}});a&&console.warn("Auth metadata sync failed:",a.message),k.Am.success("Profile updated successfully!")}catch(e){k.Am.error(e.message)}finally{d(!1)}};return e?(0,r.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,r.jsx)(z.Z,{className:"w-8 h-8 animate-spin text-primary"})}):(0,r.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8 pb-20",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Settings"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Manage your account preferences and profile information."})]}),(0,r.jsxs)(i.Zb,{className:"border-border bg-card shadow-sm",children:[(0,r.jsxs)(i.Ol,{children:[(0,r.jsxs)(i.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(S.Z,{className:"w-5 h-5 text-blue-500"}),"Profile Information"]}),(0,r.jsx)(i.SZ,{children:"Update your public profile details."})]}),(0,r.jsxs)(i.aY,{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4 p-6 bg-muted/20 border border-border rounded-3xl border-dashed",children:[(0,r.jsxs)("div",{className:"relative group cursor-pointer",children:[(0,r.jsxs)(P.Avatar,{className:"h-32 w-32 border-4 border-background shadow-2xl transition-transform duration-500 group-hover:scale-105",children:[(0,r.jsx)(P.AvatarImage,{src:T,alt:h,className:"object-cover"}),(0,r.jsx)(P.AvatarFallback,{className:"bg-blue-500/10 text-blue-400 text-3xl font-black",children:h?h.substring(0,2).toUpperCase():"P"})]}),(0,r.jsxs)("label",{htmlFor:"avatar-upload",className:"absolute inset-0 flex flex-col items-center justify-center bg-black/60 opacity-0 group-hover:opacity-100 transition-all rounded-full cursor-pointer backdrop-blur-[2px]",children:[(0,r.jsx)(A.Z,{className:"w-8 h-8 text-white mb-1"}),(0,r.jsx)("span",{className:"text-[10px] text-white font-black uppercase tracking-widest",children:"Update"})]}),(0,r.jsx)("input",{id:"avatar-upload",type:"file",accept:"image/*",className:"hidden",onChange:V,disabled:L}),L&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center rounded-full",children:(0,r.jsx)(z.Z,{className:"w-8 h-8 animate-spin text-white"})})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-sm font-bold text-foreground",children:"Mission Callsign Avatar"}),(0,r.jsx)("p",{className:"text-[10px] text-muted-foreground uppercase tracking-widest font-bold mt-1",children:"PNG, JPG or WEBP â€¢ MAX 2MB"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c,{htmlFor:"username",children:"Username"}),(0,r.jsx)(l.I,{id:"username",value:h,onChange:e=>f(e.target.value),placeholder:"drone_master"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c,{htmlFor:"fullname",children:"Full Name"}),(0,r.jsx)(l.I,{id:"fullname",value:g,onChange:e=>y(e.target.value),placeholder:"Alex Kamau"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c,{htmlFor:"bio",children:"Bio"}),(0,r.jsx)(u.g,{id:"bio",value:N,onChange:e=>E(e.target.value),placeholder:"Tell us about yourself...",className:"resize-none h-24"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c,{children:"School"}),(0,r.jsx)(l.I,{value:I,onChange:e=>B(e.target.value),placeholder:"Nairobi Academy"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c,{children:"Grade Level"}),(0,r.jsxs)(p,{value:G,onValueChange:F,children:[(0,r.jsx)(v,{children:(0,r.jsx)(b,{placeholder:"Select Grade"})}),(0,r.jsxs)(j,{children:[(0,r.jsx)(w,{value:"grade_7",children:"Grade 7"}),(0,r.jsx)(w,{value:"grade_8",children:"Grade 8"}),(0,r.jsx)(w,{value:"grade_9",children:"Grade 9"}),(0,r.jsx)(w,{value:"grade_10",children:"Grade 10"}),(0,r.jsx)(w,{value:"grade_11",children:"Grade 11"}),(0,r.jsx)(w,{value:"grade_12",children:"Grade 12"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c,{children:"Country"}),(0,r.jsx)(l.I,{value:M,onChange:e=>Y(e.target.value),placeholder:"Kenya"})]})]})]})]}),(0,r.jsxs)(i.Zb,{className:"border-border bg-card shadow-sm",children:[(0,r.jsxs)(i.Ol,{children:[(0,r.jsxs)(i.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(C.Z,{className:"w-5 h-5 text-purple-500"}),"Privacy"]}),(0,r.jsx)(i.SZ,{children:"Control who can see your progress and activity."})]}),(0,r.jsxs)(i.aY,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-muted/30 rounded-xl border border-border",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(c,{className:"text-base",children:"Show on Leaderboard"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Allow your name and score to appear on the public ranking."})]}),(0,r.jsx)(_.r,{checked:X.show_on_leaderboard,onCheckedChange:e=>q({...X,show_on_leaderboard:e})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-muted/30 rounded-xl border border-border",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(c,{className:"text-base",children:"Share with Teacher"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Allow your designated teachers to view your mission code and progress."})]}),(0,r.jsx)(_.r,{checked:X.share_with_teacher,onCheckedChange:e=>q({...X,share_with_teacher:e})})]})]})]}),(0,r.jsxs)(i.Zb,{className:"border-border bg-card shadow-sm",children:[(0,r.jsxs)(i.Ol,{children:[(0,r.jsxs)(i.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(Z.Z,{className:"w-5 h-5 text-orange-500"}),"Notifications"]}),(0,r.jsx)(i.SZ,{children:"Manage how you receive alerts and updates."})]}),(0,r.jsx)(i.aY,{children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground bg-muted p-4 rounded-xl border border-border italic text-center",children:"Advanced notification settings coming soon in Phase 2."})})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-4 p-6 bg-card border border-border rounded-2xl shadow-lg sticky bottom-8 z-50",children:[(0,r.jsx)(x.z,{variant:"outline",children:"Discard Changes"}),(0,r.jsx)(x.z,{onClick:D,disabled:a,className:"bg-blue-600 hover:bg-blue-700 text-white min-w-[140px]",children:a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O.Z,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]})}},50660:function(e,t,a){"use strict";a.r(t),a.d(t,{Avatar:function(){return i},AvatarFallback:function(){return d},AvatarImage:function(){return l}});var r=a(3827);a(64090);var s=a(12178),n=a(1657);function i(e){let{className:t,...a}=e;return(0,r.jsx)(s.fC,{"data-slot":"avatar",className:(0,n.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...a})}function l(e){let{className:t,...a}=e;return(0,r.jsx)(s.Ee,{"data-slot":"avatar-image",className:(0,n.cn)("aspect-square size-full",t),...a})}function d(e){let{className:t,...a}=e;return(0,r.jsx)(s.NY,{"data-slot":"avatar-fallback",className:(0,n.cn)("bg-muted flex size-full items-center justify-center rounded-full",t),...a})}},85754:function(e,t,a){"use strict";a.d(t,{z:function(){return d}});var r=a(3827);a(64090);var s=a(59143),n=a(49769),i=a(1657);let l=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function d(e){let{className:t,variant:a,size:n,asChild:d=!1,...o}=e,c=d?s.g7:"button";return(0,r.jsx)(c,{"data-slot":"button",className:(0,i.cn)(l({variant:a,size:n,className:t})),...o})}},27815:function(e,t,a){"use strict";a.d(t,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return n},aY:function(){return o},eW:function(){return c},ll:function(){return l}});var r=a(3827);a(64090);var s=a(1657);function n(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function i(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function l(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",t),...a})}function d(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...a})}function o(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",t),...a})}function c(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-footer",className:(0,s.cn)("flex items-center px-6 [.border-t]:pt-6",t),...a})}},45179:function(e,t,a){"use strict";a.d(t,{I:function(){return n}});var r=a(3827);a(64090);var s=a(1657);function n(e){let{className:t,type:a,...n}=e;return(0,r.jsx)("input",{type:a,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...n})}},86443:function(e,t,a){"use strict";a.d(t,{r:function(){return i}});var r=a(3827);a(64090);var s=a(94845),n=a(1657);function i(e){let{className:t,...a}=e;return(0,r.jsx)(s.fC,{"data-slot":"switch",className:(0,n.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,r.jsx)(s.bU,{"data-slot":"switch-thumb",className:"bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0"})})}},23444:function(e,t,a){"use strict";a.d(t,{g:function(){return n}});var r=a(3827);a(64090);var s=a(1657);function n(e){let{className:t,...a}=e;return(0,r.jsx)("textarea",{"data-slot":"textarea",className:(0,s.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}},34599:function(e,t,a){"use strict";a.d(t,{O:function(){return n},e:function(){return s}});var r=a(10342);function s(){let e="https://ntmginemkxkurawsabdi.supabase.co",t="sb_publishable_RI5bB73WNkwcTpfaRR5Zlw_0rZxPXuW";if(!e||!t)throw Error("Supabase environment variables (NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY) are missing. Please ensure they are defined in .env.local and restart your development server.");return(0,r.createBrowserClient)(e,t)}let n=s()},1657:function(e,t,a){"use strict";a.d(t,{cn:function(){return n}});var r=a(75504),s=a(51367);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}}},function(e){e.O(0,[150,338,342,288,207,398,971,69,744],function(){return e(e.s=69738)}),_N_E=e.O()}]);